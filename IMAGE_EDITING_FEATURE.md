# ฟีเจอร์การแก้ไขภาพในเรื่องร้องเรียน

## ภาพรวม
ฟีเจอร์นี้ช่วยให้ Admin สามารถแก้ไขภาพในเรื่องร้องเรียนได้ โดยเฉพาะในกรณีที่ภาพไม่เหมาะสมหรือต้องการเพิ่มภาพใหม่

## วิธีการใช้งาน

### 1. เข้าสู่หน้าแก้ไขข้อมูล
- ไปที่หน้า "จัดการเรื่องร้องเรียน"
- กดปุ่ม "แก้ไขข้อมูล" ในแถวของเรื่องร้องเรียนที่ต้องการแก้ไข

### 2. แก้ไขภาพปัญหา
- ในส่วน "ภาพปัญหา" กดปุ่ม "แก้ไขภาพ"
- จะมีตัวเลือกดังนี้:
  - **เพิ่มภาพใหม่**: เลือกไฟล์ภาพจากเครื่อง (รองรับ jpg, png, gif)
  - **ลบภาพ**: กดปุ่ม "×" ที่มุมขวาบนของภาพที่ต้องการลบ
  - **ดูภาพ**: คลิกที่ภาพเพื่อดูขนาดเต็ม

### 3. แก้ไขข้อมูลอื่นๆ
- **ข้อมูลผู้แจ้ง**: แก้ไขชื่อ, เบอร์โทร, รายละเอียด
- **พิกัด**: แก้ไขตำแหน่งที่เกิดปัญหา
- **ข้อมูลระบบ**: ดูข้อมูลระบบต่างๆ

## ข้อจำกัดและข้อควรระวัง

### ขนาดไฟล์
- ภาพที่อัปโหลดต้องมีขนาดไม่เกิน 5MB
- รองรับไฟล์ภาพเท่านั้น (jpg, png, gif)

### การลบภาพ
- การลบภาพจะลบออกจากฐานข้อมูลทันที
- ไม่สามารถกู้คืนภาพที่ลบแล้วได้
- ควรยืนยันก่อนลบทุกครั้ง

### การอัปโหลด
- ภาพจะถูกอัปโหลดไปยัง Cloudinary
- ต้องมีอินเทอร์เน็ตในการอัปโหลด
- หากอัปโหลดไม่สำเร็จจะแสดงข้อความแจ้งเตือน

## API Endpoints

### 1. อัปเดตข้อมูลเรื่องร้องเรียน
```
PUT /api/submittedreports/[id]
Body: {
  location?: { lat: number, lng: number },
  images?: string[],
  detail?: string,
  fullName?: string,
  phone?: string
}
```

### 2. อัปโหลดภาพใหม่
```
POST /api/upload-complaint-image
Body: {
  reportId: string,
  imageData: string (base64)
}
```

### 3. ลบภาพ
```
DELETE /api/delete-image
Body: {
  reportId: string,
  imageUrl: string
}
```

## การพัฒนาต่อ

### ฟีเจอร์ที่อาจเพิ่มในอนาคต
- การแก้ไขภาพ (crop, resize, filter)
- การอัปโหลดหลายภาพพร้อมกัน
- การจัดเรียงลำดับภาพ
- การเพิ่มคำอธิบายภาพ
- การแจ้งเตือนเมื่อมีการแก้ไขภาพ

### การปรับปรุงประสิทธิภาพ
- การบีบอัดภาพอัตโนมัติ
- การใช้ lazy loading สำหรับภาพ
- การ cache ภาพ
- การตรวจสอบความเหมาะสมของภาพด้วย AI

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย
1. **อัปโหลดไม่สำเร็จ**: ตรวจสอบขนาดไฟล์และประเภทไฟล์
2. **ภาพไม่แสดง**: ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต
3. **ลบภาพไม่ได้**: ตรวจสอบสิทธิ์การเข้าถึง

### การติดต่อผู้ดูแลระบบ
หากพบปัญหาที่ไม่สามารถแก้ไขได้ กรุณาติดต่อผู้ดูแลระบบพร้อมข้อมูล:
- Complaint ID
- ข้อความผิดพลาด
- ขั้นตอนที่ทำก่อนเกิดปัญหา
